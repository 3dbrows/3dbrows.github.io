<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <title>3dbrows.dev</title>
    <meta name="description" content="ðŸ¤ ">
    <meta name="author" content="3dbrows">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <h1>3dbrows</h1>
    <div>
        <div id="left">
            <div class="box">
                <h3>Dad, software/DevOps engineer, middle-of-nowhere Scotland.</h3>
            </div>
            <div class="box">
                <img alt="Image generated by github.com/3dbrows/txt2png"
                    src="data:image/png;base64,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" />
            </div>
            <div class="box">
                <ul>
                    <li><a href="#nonpublic-trusted-tls">Startup idea: <code>.nonpublic</code> trusted TLS</a></li>
                </ul>
            </div>
        </div>
        <div id="right">
            <div class="box" id="nonpublic-trusted-tls">
                <h2>Startup idea: <code>.nonpublic</code> trusted TLS</h2>
                <h4>2021-07-23</h4>
                <p>Accessing an intranet website protected with a self-signed TLS certificate is not a smooth
                    experience. The browser does not trust the certificate unless it is installed in the OS trust store
                    or explicitly accepted; bypassing the security warning makes a norm out of dismissing them;
                    developers are discouraged from making TLS a first-class part of their local environment because of
                    these
                    issues. How can we solve this problem and make accessing <code>https://foo.bar.local</code>
                    error-free, with a widely-trusted certificate? And is there a viable business idea in the solution?
                </p>
                <p>Recently I explored the viability of creating a new gTLD, <code>.nonpublic</code>, and becoming a DNS
                    registrar. Users would purchase a zone for a small fee, such as <code>bar.nonpublic</code>. There
                    would be an unusual twist to this TLD: no <code>A</code>, <code>AAAA</code>, <code>CNAME</code>,
                    <code>MX</code> etc. records would be accepted. Only
                    <code>TXT</code> records would be accepted, with the intention being that these would be used to
                    satisfy DNS-01
                    ACME challenges for the issuance of TLS certificates, e.g. to <code>*.bar.nonpublic</code>.
                </p>
                <p>Intranets would be expected to have their own internal DNS resolvers handling lookups for
                    <code>foo.bar.nonpublic</code>. Using the upstream root nameserver for <code>.nonpublic</code> would
                    result in <code>NXDOMAIN</code>. WHOIS searches would return nothing. The grand idea is that a
                    developer could use a service like Let's Encrypt to obtain a TLS certificate for an internal domain
                    but strictly forbid any information about the internal network being stored in the public internet.
                    Use of <code>.nonpublic</code> would therefore not in itself require egress traffic (except when
                    minting certificates).
                </p>
                <p>A number of design decisions have been briefly touched upon here, which are worth discussing:</p>
                <p>
                <ul>
                    <li><b>Zones.</b> Purchase of a zone like <code>bar.nonpublic</code> for your exclusive use is
                        necessary. One might wonder why that is so: after all, if all record lookups (except
                        <code>TXT</code>) will
                        receive <code>NXDOMAIN</code>, what does it matter if two networks internally know themselves as
                        that zone? The answer is that if I am able to mint a certificate for any given zone, without
                        precondition, then I pose a serious threat to you if I can gain such access to your systems as
                        to poison your internal DNS. In other words, if I could re-point your internal resolution of
                        <i>your</i> <code>foo.bar.nonpublic</code> to my own site, and present a certificate for same,
                        then I've pwned you. For this reason, only one party will be able to own a zone at a given time;
                        2FA will be required to log in to generate API credentials for programmatic
                        <code>TXT</code> record updates as part of the DNS-01 ACME challenge.
                    </li>
                    <li><b>Non-resolution of any name to any IP.</b> The central principle of the
                        <code>.nonpublic</code> gTLD is that it is for use by non-public sites to obtain trusted
                        certificates for their internal endpoints, and nothing else. It is not your intranet's service
                        discovery mechanism. Any name lookups within a network with this TLD should be resolved by an
                        internal nameserver: attempts to use the root nameserver will purposefully fail. This prevents
                        leakage about your internal service topography. Additionally, there will be limits on the number
                        of <code>TXT</code> records per zone at a given time, to prevent abuse.
                    </li>
                    <li><b>Reliance upon use of well-known CAs.</b> We're trying to avoid the problem of browsers
                        rejecting self-signed certificates. We therefore want to use certificate authorities which are
                        typically already trusted in the trust stores of mainstream operating systems. Let's Encrypt is
                        the obvious example.</li>
                    <li><b>Low cost.</b> A few dollars per year per zone is about right. The mission is to maximally
                        increase the trivial adoption of TLS everywhere, with a focus on internal networks. A low cost
                        means a low barrier to entry.</li>
                    <li><b>Careful choice of gTLD.</b> We can't register, for instance, <code>.local</code> because it
                        has special meaning in many systems (though isn't <a
                            href="https://datatracker.ietf.org/doc/html/rfc2606" target="_blank">RFC-reserved</a>) and
                        Let's Encrypt
                        won't mint certificates for its subdomains. The idea of
                        choosing <code>.nonpublic</code> is that it clearly indicates the intention of the domain.</li>
                </ul>
                </p>
                <h3>Resources required</h3>
                <p>A gTLD <a href="https://newgtlds.icann.org/en/applicants/global-support/faqs/faqs-en"
                        target="_blank">costs $190k to
                        set up plus $25k/year</a>. Let's pencil in $25k/year for infrastructure costs (root nameservers
                    and
                    bandwidth). Allow a further $360k/year for staffing costs related to employment of people who can
                    run the root nameservers, build and run the registrar portal and API, and generally respond to
                    enquiries. (These numbers are very minimalistic, but still minimally viable.) This totals $600k
                    in expenses. I wouldn't want to charge more than $5/zone/year. More than this hampers accessibility,
                    particularly in oppresive, lower-income countries where the adoption of TLS should be maximally
                    encouraged. Perhaps a reasonable compromise would be $3/zone/year if you will accept a
                    randomly-generated zone (e.g. <code>gs23favv9.nonpublic</code>) and a $10/year/zone "premium"
                    product if you want to
                    specify the zone name. With 10% adoption of the premium product, we can quickly see that we break
                    even at approximately 163k zones. This
                    does not seem crazy.</p>
                <h3>Arguments against</h3>
                <p>
                <ul>
                    <li><b>Why not just register <code>foobar.com</code> in Route53 and have a private zone for this
                            purpose?</b> Certainly you can do that, and many people do. But:
                        <ol>
                            <li>Let's not encourage such vendor lock-in. (Not that you need to use AWS, of course.)</li>
                            <li>You lose the (counter-intuitive) feature of <i>guaranteed</i> <code>NXDOMAIN</code> for
                                everything - the feature which forces you not to use remote nameservers for your
                                internal systems.</li>
                            <li>Your private zone might quickly morph into a service discovery system requiring dynamic
                                DNS updates.</li>
                            <li>Good luck using AWS in Iran etc.</li>
                            <li>This line of argument reminds me somewhat of how you can <a
                                    href="https://news.ycombinator.com/item?id=9224" target="_blank">"trivially" replace
                                    Dropbox</a>
                                with SFTP, clever filesystem mounting and a VCS. Yes, you are right, but the point is to
                                create a convenient product targeted at solving a particular problem.</li>
                        </ol>
                    <li><b>You know that there is a <a href="https://crt.sh" target="_blank">public record</a> of Let's
                            Encrypt
                            certificates, right?</b> You're
                        pointing out that service topographies might be thereby revealed. We avoid this problem by
                        defaulting to randomly-generated zones and recommending use of wildcard certificates, which
                        reveal no useful information.</li>
                </ul>
                </p>
                <h3>Risks</h3>
                <p>Unfortunately, there are several, serious risks with this idea.</p>
                <p>
                <ol>
                    <li>What if Let's Encrypt decide they don't like the idea and refuse to issue certificates for this
                        gTLD?</li>
                    <li>What if GoDaddy, or similar, say "cool idea bro" and replicate it within a week?</li>
                    <li>What if someone tries to sue me for wanting to keep my monopoly of registrars for the gTLD?</li>
                </ol>
                </p>
                <h3>Risk Mitigations</h3>
                <p>Are there ways we can de-risk this as a business idea? What about the following?</p>
                <p>
                <ol>
                    <li>Register <code>nonpublic.co.uk</code> or perhaps <code>nonpub.lc</code> (St. Lucia, if you're
                        wondering). Customers purchase zones like <code>bar.nonpub.lc</code> and get TLS certificates
                        for, say, <code>*.bar.nonpub.lc</code>.</li>
                    <li>Run a couple of nameservers for this domain on cheap VPSs and delegate <code>nonpub.lc</code> to
                        them.</li>
                    <li>Don't spend thousands on a gTLD, or staff; instead spend a few hundred on building out an MVP
                        myself.</li>
                </ol>
                </p>
                <p>There is a fatal flaw: <b>Let's Encrypt rate limits.</b> Everyone using this service would present to
                    Let's Encrypt as a subdomain of <code>nonpub.lc</code>, and <i>very</i> quickly exhaust rate limits.
                </p>
                <h3>Conclusion</h3>
                <p>The above-discussed arguments against, and risks, are actually pretty strong. Registering a name for
                    the purposes of certificate generation, but just never using that domain for anything else, is
                    trivial to do for anyone who sufficiently understands the motivations. Internal DNS setups to point
                    <code>example.com</code> somewhere internal aren't hard. There isn't a mass consumer product in
                    this, as in the case of Dropbox. And there is plenty of scope for this whole plan to be sunk below
                    the waterline should Let's Encrypt object; and it could be replicated in a week by a bigger player.
                </p>
                <p>Therefore, sadly, it seems there isn't a viable startup idea here after all.</p>
            </div>
        </div>
    </div>
</body>

</html>